---
phase: 04-realtime-compliance
plan: 03
type: execute
wave: 1
wave_type: ASYNC
depends_on: []
files_modified:
  - server/app/middleware/observability.py
  - server/tests/test_realtime.py
autonomous: true
difficulty: easy
---

<objective>
Add observability middleware (request logging, metrics) and tests for WebSocket + GDPR.
</objective>

<tasks>
<task type="auto">
  <name>Create observability middleware and tests</name>
  <files>
    server/app/middleware/observability.py
    server/tests/test_realtime.py
  </files>
  <action>
    Observability middleware:
    - Request/response logging with timing
    - Structured log format (JSON)
    - Request ID tracking (X-Request-ID header)
    - Slow request warnings (>1s)

    Tests:
    - WebSocket connection + auth
    - WebSocket room join/leave
    - GDPR export returns data
    - GDPR categories listing
    - Observability middleware adds headers
  </action>
</task>
</tasks>
