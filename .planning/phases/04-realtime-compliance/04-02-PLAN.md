---
phase: 04-realtime-compliance
plan: 02
type: execute
wave: 1
wave_type: ASYNC
depends_on: []
files_modified:
  - server/app/services/gdpr.py
  - server/app/routers/gdpr.py
autonomous: true
difficulty: medium
---

<objective>
Implement GDPR data subject request endpoints for data export and deletion.
</objective>

<tasks>
<task type="auto">
  <name>Create GDPR service and router</name>
  <files>
    server/app/services/gdpr.py
    server/app/routers/gdpr.py
  </files>
  <action>
    GDPR service:
    - export_user_data(client, user_id) — collect all user data across tables, return as JSON archive
    - delete_user_data(client, user_id) — cascade delete across all tables with audit log
    - get_data_categories(user_id) — list what data categories exist for user
    - Tables to process: skills, habits, reflexes, skill_executions, project_members

    GDPR router:
    - POST /gdpr/export — trigger data export (returns download URL or inline JSON)
    - POST /gdpr/delete — request account deletion (with confirmation token)
    - GET /gdpr/categories — list stored data categories
    - All endpoints require auth + confirmation for destructive operations
  </action>
</task>
</tasks>
